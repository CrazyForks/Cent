请帮我使用github api编写一个typescript lib，先不要立即给出代码，而是与我一起分析下面的需求，在最终确认后再给出最终的代码，我的需求如下：
我想将github git仓库作为一个纯前端记账app的存储库，用户在web app中记账后，对应的数据会作为文本文件保存在github仓库中，保证用户的数据不会丢失，并且能在登录github账号后得到同步

记账app的名称为Oncent，这个记账app的数据构成如下：
1，一条记账记录 Entry，用于记录单条支出或者收入，只对应一个用户；
2，一份账单，用于记录多条记账记录 Ledger ，表示一个人所记录的所有收入和支出；
3，一份账本 Journal，多个人的账单集合在一起组成一本账本

也就是说，我希望当用户在app中创建一本账本，并记录了一笔记账记录后，git仓库结构如下，假设用户名为usera：
```
github.com/usera/oncent-journal-journal1(仓库地址)
-- config.json(账本的全局配置文件，用于记录账单的名称，备注，同时也可以用于为后续账单添加更多功能作准备)
-- /usera-id(由用户的github id命名的文件夹)
---- ledger.json(固定名称，记录对应用户的账单数据)
---- ledger.config.json(固定名称，记录对应用户的账单配置，为后续功能作准备)
---- /assets(固定名称文件夹，用于存放用户记账时附带的图片文件或者其他素材)
```
之所以要使用用户的id作为文件夹包裹账单数据，是因为该app还支持共享账本，可以将一个账本共享给其他用户共同进行编辑，因此需要用id来进行不同用户的区分。共享功能可以通过github的仓库协作功能来进行，即一个仓库的所有协作者都可以被视为共享用户，都可以单独写入自己的账单信息。

我希望我可以通过lib暴露出的api，就可以轻松完成包括但不限于下面的功能：
账本Journal：
1，创建账本
2，获取所有可用的账本，除了自己创建的账本外，也可以获取共享的他人账本
2，修改全局账本配置文件，即修改全局config.json
3，获取全局账本信息，即获取全局config.json的内容
4，获取所有共享者的账单内容ledger.json，以及账单配置信息ledger.config.json

账单Ledger
1，获取所有记账记录Enter
2，创建新的记账记录
3，删除或者更改指定的记账记录

通过这些功能，我可以只关心传入的数据格式，而不用再考虑背后的存储过程，lib中的逻辑应当自动帮助处理这些数据，并将其写入到真实的github仓库中。

有一些细节我已经注意到了：
1，github仓库不能重名，因此需要对账本名称规则做出一定的限制，例如账本仓库只能以oncent-journal-开头，后面接入用户输入的账本名字（需要normalize处理保证符合github仓库命名规则，例如去掉非法字符，中文转换成拼音等），用户输入的账本真实名称应该被保存在全局config.json中。同时，设定一个命名规则也可以便于区分账本仓库和其他普通仓库，避免错误提交
2，git频繁提交问题，当日积月累后，账单文件ledger.json会变得越来越大，导致后续每次提交都会变得越来越慢，是否有办法可以解决？

请帮我分析上面的需求，是否有可以简化或者改进的地方？对于我注意到的问题，是否有比较好的解决方法？给出你的思考，在这之后，我将给你下一步指令。


我选择使用分文件设计，但是不要将文件分得太细，我建议根据存储的条目数量进行拆分，例如一个文件只存2000条数据。
之所以基于条目而非时间，是因为我希望这个lib能支持更高级的抽象，而不仅仅是用于记账这一个项目，对于其他使用这个lib的项目来说，时间信息可能并不是数组item的一部分。
我希望在后续的api设计中也考虑这一点，lib本身其实是用于实现“通过github api存储和共享数组类型数据”这一功能，而数组内容本身的格式，以及配置文件的格式等，都应该由使用者来定义。例如，通过传入数组Item类型，可以自动得到类型推断，而后面的实现对使用者来说是完全透明的

对于下面几个问题，我也分别给出回答：
四、接下来我们可以确认细节：

请你确认下面几个关键点：

Chunk 存在哪个目录？ 默认建议 chunks/; 是否希望可配置？

index.json 的结构是否满足需求？是否希望 index 里记录额外的统计信息（例如最后更新时间、checksum、creator 等）？

操作粒度：除了 appendItems，是否需要提供“按 item 索引随机删除/更新单条”能力？如果需要，我们应当为用户提供方便 API（例如：给出 item 的 global index 自动定位所在 chunk）。

冲突策略：当多人同时写最后一个 chunk 或 index，冲突发生时应如何处理？你倾向于“失败重试 fancier merge”还是“暴露冲突给使用者 UI 决定”？

批量提交策略：是否默认把 appendItems 的上传合并为一个 commit（推荐）？还是每次 append 都单独 commit？

assets / 关联文件支持？：本库是否也应支持附加上传单条 item 的关联文件（如照片）？如果是，建议把关联文件路径或外部 url 写入 item。
回答：
1，我希望chunk与ledger.json文件同级，例如 ledger-001.json, ledger-002.json ，这部分内容对于使用者来说应该是完全透明的，不需要支持可配置
2，不需要index.json，直接通过chunk文件名来进行读取，全量读取并不是坏事，当用户进行增删改操作时，直接更新对应的chunk内容即可
3，我希望针对远程数组的操作就像用户通过普通的异步方法操作数据库条目一样简单，需要支持指定id对特定的数组条目进行修改
4，不考虑冲突策略，所有更新由最新用户提交的数据决定，不过可以考虑配置删除策略，即当用户选择删除某个条目时，是直接删掉对应记录，还是将记录字段中的_deleted_at设置为当前时间，后续getList时直接过滤掉_deleted_at存在的字段
5，我喜欢批量提交策略，例如暴露一个batchUpdate，传入一个对象，用于表示对哪些数据进行修改、删除，或者新增，就像Dexiejs那样，当然用户也可以单条更新，其实就相当于batchUpdate的语法糖。
6，assets对用户来说也应该是透明的，当用户在传入的更改中附带了file对象时，例如{imageFile:new File()}时，lib会自动将imageFile保存为类似于:{"@imageFile":"assets/fileid.ext"}的结构，并将File存储在asset目录下，其在还原时会被转换为{imageFile: string}的结构，imageFile的值会被转换为github的在线地址。这一点同样也需要在类型定义里体现出来，即所有传入的File对象，在getList返回值中都应该被转换为string。同时，用户也可以指定uploader选项，自定义要将文件上传到其他第三方服务，只需要返回一条string地址即可，如果用户不指定，则会默认上传至github 仓库对应的assets文件夹中

另外请注意，lib api应该是针对多个账本，包括共享账本的设计，即用户可以看到自己能够访问哪些账本，包括共享账本，当执行具体操作时，需要传入对应账本信息
请先给出初步 TypeScript 代码结构，并添加详细的注释


你做的很不错，但是有几点需要修改：
1，RemoteArrayRepo本身不直接处理token如何获取，它只需要接收token，例如接收一个 ()=>Promise<string> 的函数，在需要用到token时才调用
2，owner和repo并不需要传入，可以通过token直接获取，我希望这些是懒运行的，只有在真正开始调用函数后才开始运行，例如getList，后续可以保存在内存中无需重复获取
3， getList 和getById这些函数，需要使用typescript工具将Item类型转换为UploadedItem，即递归地将file对象值转换为string
请先给出修改后的typescript结构，不需要实现具体逻辑